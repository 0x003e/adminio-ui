<div class="container" style="padding-top: 30px;">
	<h1>List of users</h1>
	<table class="table">
		<thead class="thead-light">
			<tr>
				<th>User name</th>
				<th>Policy</th>
				<th>Status</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody *ngIf="users">
			<tr *ngFor="let key of objectKeys(users)" [ngClass]="users[key].status == 'disabled' ? 'table-secondary' : 'none' && !users[key].policyName ? 'table-warning' : 'none' ">
				<td>{{key}}</td>
				<td><span *ngIf="users[key].policyName">{{users[key].policyName}}</span></td>
				<td>
					<div class="custom-control custom-switch" title="enable or disable user">
					  <input type="checkbox" class="custom-control-input" id="customSwitch{{key}}" [attr.checked]="users[key].status == 'enabled' ? '' : null" (click)="setStatusUser(key,users[key].status)">
					  <label class="custom-control-label" for="customSwitch{{key}}">&nbsp;{{users[key].status}}</label>
					</div>
				</td>
				<td>
					<a title="Remove User" (click)="deleteUserPrepare(key); deleteApproveModal.show()"><mdb-icon fas icon="trash" size="1x" class="red-text pr-3" aria-hidden="true"></mdb-icon></a>
				</td>
			</tr>
		</tbody>
	</table>
	<button type="button" mdbBtn color="primary" class="relative waves-light" mdbWavesEffect rounded="true" data-toggle="modal" data-target="#addUser"
  (click)="addUserModal.show()" mdbWavesEffect>Add user</button>
</div>

<!-- delete approve modal -->

<div mdbModal #deleteApproveModal="mdbModal" class="modal fade right" tabindex="-1" role="dialog" aria-labelledby="myBasicModalLabel"
   aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close pull-right" aria-label="Close" (click)="deleteApproveModal.hide()">
                    <span aria-hidden="true">Ã—</span>
                </button>
                <h4 class="modal-title w-100" id="myModalLabel">Remove User</h4>
            </div>
            <div class="modal-body">
                Are you shure? <br/> After you click on <strong>"Delete"</strong> button user <strong>{{userToDelete}}</strong> will be removed.
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" mdbBtn color="secondary" class="waves-light" aria-label="Close" (click)="deleteApproveModal.hide()" mdbWavesEffect>Cancel</button>
                <button type="button" mdbBtn color="primary" class="relative waves-light" mdbWavesEffect (click)="deleteUser(); deleteApproveModal.hide()">Delete</button>
            </div>
        </div>
    </div >
</div >

<!-- user create modal -->

<div mdbModal #addUserModal="mdbModal" class="modal fade left" id="frameModalTop" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Create new user</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="addUserModal.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="defaultForm-access" [formControl]="newUserAccess" class="form-control"
                 mdbInput mdbValidate>
          <label for="defaultForm-access">Access Key</label>
          <mdb-error *ngIf="newUserAccess.invalid && (newUserAccess.dirty || newUserAccess.touched)">
            Input invalid
          </mdb-error>
          <mdb-success *ngIf="newUserAccess.valid && (newUserAccess.dirty || newUserAccess.touched)">
          	Input valid
          </mdb-success>
        </div>

        <div class="md-form mb-4">
          <input type="text" id="defaultForm-secret" [formControl]="newUserSecret" class="form-control"
                 mdbInput mdbValidate>
          <label for="defaultForm-secret">Secret Key</label>
          <mdb-error *ngIf="newUserSecret.invalid && (newUserSecret.dirty || newUserSecret.touched)">
            Input invalid
          </mdb-error>
          <mdb-success *ngIf="newUserSecret.valid && (newUserSecret.dirty || newUserSecret.touched)">
            Input valid
          </mdb-success>
        </div>

       	<div class="md-form mb-4">
       		<select class="browser-default custom-select" [formControl]="newUserPolicy" title="select policy">
			  <option value="" disabled selected>Select policy</option>
			  <option [value]="policy" *ngFor="let policy of policies">{{policy}}</option>
			</select>
       	</div>

        <div class="md-form mb-4">
        	<p class="font-small blue-text d-flex justify-content-end">
            	<a class="blue-text ml-1" (click)="resetForm()">Generate</a>
          	</p>
         </div>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button mdbBtn color="default" class="waves-light" mdbWavesEffect (click)="createUser()">Create</button>
      </div>
    </div>
  </div>
</div>



